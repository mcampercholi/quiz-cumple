<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Â¡Premio desbloqueado! ğŸ‰</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <!-- Confetti CDN -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
</head>
<body>
   <!-- ===== NAVBAR ===== -->
  <div class="navbar">
    <div class="nav-inner">
      <!-- Izquierda: Reiniciar -->
      <div class="nav-left">
        <button class="nav-btn nav-reset" onclick="window.location.href='{{ url_for('reset') }}'">
          <span class="icon">ğŸ”„</span><span class="label">Reiniciar</span>
        </button>
      </div>

      <!-- Centro: marcador + vidas -->
      <div class="nav-center">
        <div class="score-board" aria-live="polite">
          <span class="score-value-led">
            <span id="nav-score">{{ score }}</span>
            <span class="score-sep">/</span>
            <span class="score-target">{{ target }}</span>
          </span>
        </div>
        <!-- vidas (igual que en quiz, sin JS) -->
        <div class="lives-board" aria-label="Vidas">
          {% for i in range(max_lives) %}
            <span class="heart{% if i >= lives %} lost{% endif %}">â¤ï¸</span>
          {% endfor %}
        </div>
      </div>

      <!-- Derecha: Mute -->
      <div class="nav-right">
        <button id="muteBtn" class="nav-btn" type="button">
          <span class="icon">ğŸ”‡</span><span class="label">Mute</span>
        </button>
      </div>
    </div>
  </div>

  <!-- ===== CONTENIDO ===== -->
  <div class="quiz-container">
    <h1> Â¡Ueeeee! </h1>
    <p class="feedback correct" style="margin-top:0;">Te ganaste esta super lonchera.</p>

    <!-- GalerÃ­a de fotos del regalo -->
    <div class="reward-images">
      <img  class="price-img"
            style="max-width:460px;width:100%;height:auto;display:block;margin:0 auto;" 
            src="{{ url_for('static', filename='images/regalo1.jpg') }}" alt="Regalo 1">
      <img  class="price-img"
            style="max-width:460px;width:100%;height:auto;display:block;margin:0 auto;" 
            src="{{ url_for('static', filename='images/regalo2.jpg') }}" alt="Regalo 2">
    </div>

  </div>

  <!-- Jingle del premio -->
  <audio id="premio-audio" src="{{ url_for('static', filename='audio/premio.mp3') }}" preload="auto"></audio>

  <script>
    const muteBtn = document.getElementById('muteBtn');
    const premioAudio = document.getElementById('premio-audio');
    let isMuted = localStorage.getItem('quiz_muted') === '1';

    function applyMute() {
      if (premioAudio) premioAudio.muted = isMuted;
      muteBtn?.querySelector('.label')?.replaceChildren(
        document.createTextNode(isMuted ? 'Unmute' : 'Mute')
      );
      localStorage.setItem('quiz_muted', isMuted ? '1' : '0');
    }
    muteBtn?.addEventListener('click', () => { isMuted = !isMuted; applyMute(); });

    document.addEventListener('DOMContentLoaded', () => {
      applyMute();

      if (!isMuted && premioAudio) {
        premioAudio.currentTime = 0;
        premioAudio.play().catch(() => {
          const unlock = () => {
            premioAudio.play().finally(() => {
              window.removeEventListener('click', unlock);
              window.removeEventListener('keydown', unlock);
              window.removeEventListener('touchstart', unlock);
            });
          };
          window.addEventListener('click', unlock, { once:true });
          window.addEventListener('keydown', unlock, { once:true });
          window.addEventListener('touchstart', unlock, { once:true });
        });
      }

      // confetti original de tu meta (si lo usÃ¡s)
      const burst = (opts={}) => confetti(Object.assign({
        particleCount: 120,
        spread: 80,
        origin: { y: 0.6 }
      }, opts));
      burst();
      let n = 0;
      const timer = setInterval(() => {
        burst({ particleCount: 60, spread: 70 });
        if (++n > 4) clearInterval(timer);
      }, 900);
    });
  </script>
</body>
</html>
